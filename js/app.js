function addScore(event){event.preventDefault();var select=document.querySelector(".form-score select");db.transaction(function(tx){tx.executeSql("INSERT INTO histories (date, score) values (?, ?)",[new Date,select.value],function(){})})}function changeScore(event,select){for(var str=("0"+select.value).slice(-3),spans=document.querySelectorAll(".form-score .number"),i=0,l=str.length;l>i;i++)spans[i].innerHTML=str[i]}var db=openDatabase("scoreboard","","",1048576);db.transaction(function(tx){tx.executeSql("CREATE TABLE IF NOT EXISTS histories (date DATE, score INT)"),tx.executeSql("SELECT SUM(score) sum FROM histories",null,function(tx,result){var sum=result.rows.item(0).sum,elem=document.querySelector(".score-total strong");elem.innerHTML=sum;var progressBar=document.querySelector("#scores .progress-bar");progressBar.style.width=sum/10+"%"}),tx.executeSql("SELECT * FROM histories ORDER BY rowid DESC",null,function(tx,result){for(var logs="",i=0,l=result.rows.length;l>i;i++){var v=result.rows.item(i),date=new Date(v.date),dateStr=date.getFullYear()+"-"+(date.getMonth()||12)+"-"+date.getDate();logs+='<div class="row log"><div class="col-xs-6 date">'+dateStr+'</div><div class="col-xs-6 score">获得积分<strong>'+v.score+"</strong></div></div>"}var container=document.querySelector("#history .container");container.innerHTML+=logs})});